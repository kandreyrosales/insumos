{% extends 'base.html' %}
{% block content %}
    <!-- Modal Create Order -->
    <div class="modal fade" id="add_order_modal" tabindex="-1" aria-labelledby="addOrderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="modal-add-insumos-title w-100 text-center" id="addInsumosModalLabel">Formulario de Solicitud</span>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid" id="modal_create_order_container">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Modal Create Order -->

    <script>
        // Mantener el estado de los checkboxes entre páginas
        const selectedItems = new Set();
        document.addEventListener('change', (event) => {
            if (event.target.name === 'iteminsumo') {
                if (event.target.checked) {
                    selectedItems.add(event.target.value);
                } else {
                    selectedItems.delete(event.target.value);
                }
            }
        });

        document.addEventListener('htmx:beforeSwap', (event) => {
            // Antes de reemplazar el contenido, almacenar los checkboxes seleccionados
            const inputs = event.target.querySelectorAll('input[name="iteminsumo"]:checked');
            inputs.forEach(input => selectedItems.add(input.value));
        });

        document.addEventListener('htmx:afterSwap', (event) => {
            // Después de reemplazar el contenido, restaurar los checkboxes seleccionados
            const inputs = event.target.querySelectorAll('input[name="iteminsumo"]');
            inputs.forEach(input => {
                if (selectedItems.has(input.value)) {
                    input.checked = true;
                }
            });
        });
        function get_ids_from_checkboxes(){
            return JSON.stringify(Array.from(selectedItems))
        }

    </script>

    <div class="row" id="main_row">
        <div class="col">
            <div class="row">
                <span id="insumos_title">Insumos</span>
            </div>
            <div class="container-fluid" id="table_container_index">
                <div class="row">
                    <div class="d-grid d-flex justify-content-between">
                        <a href="#" id="a_svg_generate_order" data-bs-toggle="modal" data-bs-target="#add_order_modal" hx-get="{{ url_for('generate_insumos_list_html') }}"  hx-vals='js:{insumos_id_list: get_ids_from_checkboxes()}' hx-target="#modal_create_order_container">
                            <svg width="210" height="48" viewBox="0 0 210 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_2_448)">
                                    <rect width="210" height="48" fill="#0075A6"/>
                                    <rect width="73.4965" height="49.1609" transform="matrix(1 0 -0.215776 0.976443 161.405 0)" fill="#00617F"/>
                                    <path d="M18.4368 28.084C17.8528 28.084 17.3248 27.984 16.8528 27.784C16.3888 27.584 16.0208 27.296 15.7488 26.92C15.4768 26.544 15.3368 26.1 15.3288 25.588H17.1288C17.1528 25.932 17.2728 26.204 17.4888 26.404C17.7128 26.604 18.0168 26.704 18.4008 26.704C18.7928 26.704 19.1008 26.612 19.3248 26.428C19.5488 26.236 19.6608 25.988 19.6608 25.684C19.6608 25.436 19.5848 25.232 19.4328 25.072C19.2808 24.912 19.0888 24.788 18.8568 24.7C18.6328 24.604 18.3208 24.5 17.9208 24.388C17.3768 24.228 16.9328 24.072 16.5888 23.92C16.2528 23.76 15.9608 23.524 15.7128 23.212C15.4728 22.892 15.3528 22.468 15.3528 21.94C15.3528 21.444 15.4768 21.012 15.7248 20.644C15.9728 20.276 16.3208 19.996 16.7688 19.804C17.2168 19.604 17.7288 19.504 18.3048 19.504C19.1688 19.504 19.8688 19.716 20.4048 20.14C20.9488 20.556 21.2488 21.14 21.3048 21.892H19.4568C19.4408 21.604 19.3168 21.368 19.0848 21.184C18.8608 20.992 18.5608 20.896 18.1848 20.896C17.8568 20.896 17.5928 20.98 17.3928 21.148C17.2008 21.316 17.1048 21.56 17.1048 21.88C17.1048 22.104 17.1768 22.292 17.3208 22.444C17.4728 22.588 17.6568 22.708 17.8728 22.804C18.0968 22.892 18.4088 22.996 18.8088 23.116C19.3528 23.276 19.7968 23.436 20.1408 23.596C20.4848 23.756 20.7808 23.996 21.0288 24.316C21.2768 24.636 21.4008 25.056 21.4008 25.576C21.4008 26.024 21.2848 26.44 21.0528 26.824C20.8208 27.208 20.4808 27.516 20.0328 27.748C19.5848 27.972 19.0528 28.084 18.4368 28.084ZM27.2453 28.084C26.4613 28.084 25.7413 27.9 25.0853 27.532C24.4293 27.164 23.9093 26.656 23.5253 26.008C23.1413 25.352 22.9493 24.612 22.9493 23.788C22.9493 22.972 23.1413 22.24 23.5253 21.592C23.9093 20.936 24.4293 20.424 25.0853 20.056C25.7413 19.688 26.4613 19.504 27.2453 19.504C28.0373 19.504 28.7573 19.688 29.4053 20.056C30.0613 20.424 30.5773 20.936 30.9533 21.592C31.3373 22.24 31.5293 22.972 31.5293 23.788C31.5293 24.612 31.3373 25.352 30.9533 26.008C30.5773 26.656 30.0613 27.164 29.4053 27.532C28.7493 27.9 28.0293 28.084 27.2453 28.084ZM27.2453 26.584C27.7493 26.584 28.1933 26.472 28.5773 26.248C28.9613 26.016 29.2613 25.688 29.4773 25.264C29.6933 24.84 29.8013 24.348 29.8013 23.788C29.8013 23.228 29.6933 22.74 29.4773 22.324C29.2613 21.9 28.9613 21.576 28.5773 21.352C28.1933 21.128 27.7493 21.016 27.2453 21.016C26.7413 21.016 26.2933 21.128 25.9013 21.352C25.5173 21.576 25.2173 21.9 25.0013 22.324C24.7853 22.74 24.6773 23.228 24.6773 23.788C24.6773 24.348 24.7853 24.84 25.0013 25.264C25.2173 25.688 25.5173 26.016 25.9013 26.248C26.2933 26.472 26.7413 26.584 27.2453 26.584ZM34.9592 26.668H37.7192V28H33.2792V19.624H34.9592V26.668ZM40.967 19.624V28H39.287V19.624H40.967ZM42.7188 23.8C42.7188 22.976 42.9028 22.24 43.2708 21.592C43.6468 20.936 44.1548 20.428 44.7948 20.068C45.4428 19.7 46.1668 19.516 46.9668 19.516C47.9028 19.516 48.7228 19.756 49.4268 20.236C50.1308 20.716 50.6228 21.38 50.9028 22.228H48.9708C48.7788 21.828 48.5068 21.528 48.1548 21.328C47.8108 21.128 47.4108 21.028 46.9548 21.028C46.4668 21.028 46.0308 21.144 45.6468 21.376C45.2708 21.6 44.9748 21.92 44.7588 22.336C44.5508 22.752 44.4468 23.24 44.4468 23.8C44.4468 24.352 44.5508 24.84 44.7588 25.264C44.9748 25.68 45.2708 26.004 45.6468 26.236C46.0308 26.46 46.4668 26.572 46.9548 26.572C47.4108 26.572 47.8108 26.472 48.1548 26.272C48.5068 26.064 48.7788 25.76 48.9708 25.36H50.9028C50.6228 26.216 50.1308 26.884 49.4268 27.364C48.7308 27.836 47.9108 28.072 46.9668 28.072C46.1668 28.072 45.4428 27.892 44.7948 27.532C44.1548 27.164 43.6468 26.656 43.2708 26.008C42.9028 25.36 42.7188 24.624 42.7188 23.8ZM54.5178 19.624V28H52.8378V19.624H54.5178ZM62.3776 19.624V20.98H60.1456V28H58.4656V20.98H56.2336V19.624H62.3776ZM69.2394 26.404H65.9034L65.3514 28H63.5874L66.5994 19.612H68.5554L71.5674 28H69.7914L69.2394 26.404ZM68.7834 25.06L67.5714 21.556L66.3594 25.06H68.7834ZM77.5132 28L75.6652 24.736H74.8732V28H73.1932V19.624H76.3372C76.9852 19.624 77.5372 19.74 77.9932 19.972C78.4492 20.196 78.7892 20.504 79.0132 20.896C79.2452 21.28 79.3612 21.712 79.3612 22.192C79.3612 22.744 79.2012 23.244 78.8812 23.692C78.5612 24.132 78.0852 24.436 77.4532 24.604L79.4572 28H77.5132ZM74.8732 23.476H76.2772C76.7332 23.476 77.0732 23.368 77.2972 23.152C77.5212 22.928 77.6332 22.62 77.6332 22.228C77.6332 21.844 77.5212 21.548 77.2972 21.34C77.0732 21.124 76.7332 21.016 76.2772 21.016H74.8732V23.476ZM86.4201 19.624V28H84.7401V19.624H86.4201ZM95.744 28H94.064L90.26 22.252V28H88.58V19.612H90.26L94.064 25.372V19.612H95.744V28ZM100.796 28.084C100.212 28.084 99.6842 27.984 99.2122 27.784C98.7482 27.584 98.3802 27.296 98.1082 26.92C97.8362 26.544 97.6962 26.1 97.6882 25.588H99.4882C99.5122 25.932 99.6322 26.204 99.8482 26.404C100.072 26.604 100.376 26.704 100.76 26.704C101.152 26.704 101.46 26.612 101.684 26.428C101.908 26.236 102.02 25.988 102.02 25.684C102.02 25.436 101.944 25.232 101.792 25.072C101.64 24.912 101.448 24.788 101.216 24.7C100.992 24.604 100.68 24.5 100.28 24.388C99.7362 24.228 99.2922 24.072 98.9482 23.92C98.6122 23.76 98.3202 23.524 98.0722 23.212C97.8322 22.892 97.7122 22.468 97.7122 21.94C97.7122 21.444 97.8362 21.012 98.0842 20.644C98.3322 20.276 98.6802 19.996 99.1282 19.804C99.5762 19.604 100.088 19.504 100.664 19.504C101.528 19.504 102.228 19.716 102.764 20.14C103.308 20.556 103.608 21.14 103.664 21.892H101.816C101.8 21.604 101.676 21.368 101.444 21.184C101.22 20.992 100.92 20.896 100.544 20.896C100.216 20.896 99.9522 20.98 99.7522 21.148C99.5602 21.316 99.4642 21.56 99.4642 21.88C99.4642 22.104 99.5362 22.292 99.6802 22.444C99.8322 22.588 100.016 22.708 100.232 22.804C100.456 22.892 100.768 22.996 101.168 23.116C101.712 23.276 102.156 23.436 102.5 23.596C102.844 23.756 103.14 23.996 103.388 24.316C103.636 24.636 103.76 25.056 103.76 25.576C103.76 26.024 103.644 26.44 103.412 26.824C103.18 27.208 102.84 27.516 102.392 27.748C101.944 27.972 101.412 28.084 100.796 28.084ZM107.373 19.624V24.808C107.373 25.376 107.521 25.812 107.817 26.116C108.113 26.412 108.529 26.56 109.065 26.56C109.609 26.56 110.029 26.412 110.325 26.116C110.621 25.812 110.769 25.376 110.769 24.808V19.624H112.461V24.796C112.461 25.508 112.305 26.112 111.993 26.608C111.689 27.096 111.277 27.464 110.757 27.712C110.245 27.96 109.673 28.084 109.041 28.084C108.417 28.084 107.849 27.96 107.337 27.712C106.833 27.464 106.433 27.096 106.137 26.608C105.841 26.112 105.693 25.508 105.693 24.796V19.624H107.373ZM123.716 19.624V28H122.036V22.552L119.792 28H118.52L116.264 22.552V28H114.584V19.624H116.492L119.156 25.852L121.82 19.624H123.716ZM129.765 28.084C128.981 28.084 128.261 27.9 127.605 27.532C126.949 27.164 126.429 26.656 126.045 26.008C125.661 25.352 125.469 24.612 125.469 23.788C125.469 22.972 125.661 22.24 126.045 21.592C126.429 20.936 126.949 20.424 127.605 20.056C128.261 19.688 128.981 19.504 129.765 19.504C130.557 19.504 131.277 19.688 131.925 20.056C132.581 20.424 133.097 20.936 133.473 21.592C133.857 22.24 134.049 22.972 134.049 23.788C134.049 24.612 133.857 25.352 133.473 26.008C133.097 26.656 132.581 27.164 131.925 27.532C131.269 27.9 130.549 28.084 129.765 28.084ZM129.765 26.584C130.269 26.584 130.713 26.472 131.097 26.248C131.481 26.016 131.781 25.688 131.997 25.264C132.213 24.84 132.321 24.348 132.321 23.788C132.321 23.228 132.213 22.74 131.997 22.324C131.781 21.9 131.481 21.576 131.097 21.352C130.713 21.128 130.269 21.016 129.765 21.016C129.261 21.016 128.813 21.128 128.421 21.352C128.037 21.576 127.737 21.9 127.521 22.324C127.305 22.74 127.197 23.228 127.197 23.788C127.197 24.348 127.305 24.84 127.521 25.264C127.737 25.688 128.037 26.016 128.421 26.248C128.813 26.472 129.261 26.584 129.765 26.584ZM138.691 28.084C138.107 28.084 137.579 27.984 137.107 27.784C136.643 27.584 136.275 27.296 136.003 26.92C135.731 26.544 135.591 26.1 135.583 25.588H137.383C137.407 25.932 137.527 26.204 137.743 26.404C137.967 26.604 138.271 26.704 138.655 26.704C139.047 26.704 139.355 26.612 139.579 26.428C139.803 26.236 139.915 25.988 139.915 25.684C139.915 25.436 139.839 25.232 139.687 25.072C139.535 24.912 139.343 24.788 139.111 24.7C138.887 24.604 138.575 24.5 138.175 24.388C137.631 24.228 137.187 24.072 136.843 23.92C136.507 23.76 136.215 23.524 135.967 23.212C135.727 22.892 135.607 22.468 135.607 21.94C135.607 21.444 135.731 21.012 135.979 20.644C136.227 20.276 136.575 19.996 137.023 19.804C137.471 19.604 137.983 19.504 138.559 19.504C139.423 19.504 140.123 19.716 140.659 20.14C141.203 20.556 141.503 21.14 141.559 21.892H139.711C139.695 21.604 139.571 21.368 139.339 21.184C139.115 20.992 138.815 20.896 138.439 20.896C138.111 20.896 137.847 20.98 137.647 21.148C137.455 21.316 137.359 21.56 137.359 21.88C137.359 22.104 137.431 22.292 137.575 22.444C137.727 22.588 137.911 22.708 138.127 22.804C138.351 22.892 138.663 22.996 139.063 23.116C139.607 23.276 140.051 23.436 140.395 23.596C140.739 23.756 141.035 23.996 141.283 24.316C141.531 24.636 141.655 25.056 141.655 25.576C141.655 26.024 141.539 26.44 141.307 26.824C141.075 27.208 140.735 27.516 140.287 27.748C139.839 27.972 139.307 28.084 138.691 28.084Z" fill="white"/>
                                    <path d="M187.35 24.7969L180.975 31.1719C180.506 31.6406 179.803 31.6406 179.381 31.1719L178.303 30.1406C177.881 29.6719 177.881 28.9688 178.303 28.5469L182.85 24.0469L178.303 19.5C177.881 19.0781 177.881 18.375 178.303 17.9062L179.381 16.8281C179.803 16.4062 180.506 16.4062 180.975 16.8281L187.35 23.2031C187.772 23.6719 187.772 24.375 187.35 24.7969Z" fill="white"/>
                                </g>
                                <defs>
                                    <clipPath id="clip0_2_448">
                                        <rect width="210" height="48" fill="white"/>
                                    </clipPath>
                                </defs>
                            </svg>

                        </a>
                    </div>
                </div>
                <div class="row" style="margin-top: 30px" id="insumos-table" hx-get="{{ url_for('insumos_representante_list') }}" hx-trigger="load" hx-target="#insumos-table"></div>
            </div>
        </div>
    </div>
    </div>
{% endblock %}

